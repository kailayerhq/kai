import{ad as s}from"./BVvwDgQW.js";import{g as l}from"./CQNZviiM.js";const u=s(null),g=s(null),w=s(null),n="";async function f(e,a,t=null){const o={"Content-Type":"application/json"},i={method:e,headers:o,credentials:"include"};t&&(i.body=JSON.stringify(t));const r=await fetch(n+a,i);if(r.status===401&&await d()){const c=await fetch(n+a,{method:e,headers:o,credentials:"include",body:t?JSON.stringify(t):null});return c.status===204?{}:c.json()}return r.status===204?{}:r.json()}async function d(){try{if((await fetch(n+"/api/v1/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({})})).ok)return!0}catch(e){console.error("Failed to refresh token",e)}return!1}async function m(){try{await fetch(n+"/api/v1/auth/logout",{method:"POST",credentials:"include"})}catch{}u.set(null),l("/login")}async function O(){const e=await f("GET","/api/v1/me");return e.error?null:(u.set(e),e)}export{f as a,w as b,g as c,u as d,m as e,O as l};
